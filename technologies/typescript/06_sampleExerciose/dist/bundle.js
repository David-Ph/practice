(()=>{"use strict";class e{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}function n(e,t,n){const r=n.value;return{configurable:!0,enumerable:!1,get(){return r.bind(this)}}}var r;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(r||(r={}));class s{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class i extends class{constructor(){this.listeners=[]}addListeners(e){this.listeners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new i),this.instance}addProject(e,t,n){const i=new s(Math.random().toString(),e,t,n,r.Active);this.projects.push(i),this.updateListener()}switchProjectStatus(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListener())}updateListener(){for(const e of this.listeners)e(this.projects.slice())}}const o=i.getInstance();class l extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value,n=this.descriptionInputElement.value,r=this.peopleInputElement.value,s={value:n,required:!0,minLength:5},i={value:+r,required:!0,min:1,max:5};return t({value:e,required:!0,minLength:5,maxLength:50})&&t(s)&&t(i)?[e,n,+r]:void console.log("Invalid input")}submitHandler(e){e.preventDefault(),console.log(this);const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;o.addProject(e,n,r)}}}!function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);i>3&&o&&Object.defineProperty(t,n,o)}([n],l.prototype,"submitHandler",null);var a=function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};class c extends e{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 person is working on this":`${this.project.people} people is working on this`}dragStartFn(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndFn(e){console.log(this)}configure(){this.element.addEventListener("dragstart",this.dragStartFn),this.element.addEventListener("dragend",this.dragEndFn)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons,this.element.querySelector("p").textContent=this.project.description}}a([n],c.prototype,"dragStartFn",null),a([n],c.prototype,"dragEndFn",null);var u=function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,n,o):s(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o};class p extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProject=[],this.configure(),this.renderContent()}dragOverFn(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropFn(e){e.preventDefault();const t=e.dataTransfer.getData("text/plain");o.switchProjectStatus(t,"active"===this.type?r.Active:r.Finished),this.element.querySelector("ul").classList.remove("droppable")}dragLeaveFn(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverFn),this.element.addEventListener("dragleave",this.dragLeaveFn),this.element.addEventListener("drop",this.dropFn),o.addListeners((e=>{e=e.filter((e=>"active"===this.type?e.status===r.Active:e.status===r.Finished)),this.assignedProject=e,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProject){const t=this.element.querySelector("ul").id;new c(t,e)}}}u([n],p.prototype,"dragOverFn",null),u([n],p.prototype,"dropFn",null),u([n],p.prototype,"dragLeaveFn",null),new l,new p("active"),new p("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwibWFwcGluZ3MiOiJtQkFDTyxNQUFlQSxFQUtwQkMsWUFDRUMsRUFDQUMsRUFDQUMsRUFDQUMsR0FFQUMsS0FBS0MsZ0JBQWtCQyxTQUFTQyxlQUM5QlAsR0FFRkksS0FBS0ksWUFBY0YsU0FBU0MsZUFBZU4sR0FFM0MsTUFBTVEsRUFBZUgsU0FBU0ksV0FDNUJOLEtBQUtDLGdCQUFnQk0sU0FDckIsR0FFRlAsS0FBS1EsUUFBVUgsRUFBYUksa0JBQ3hCVixJQUNGQyxLQUFLUSxRQUFRRSxHQUFLWCxHQUVwQkMsS0FBS1csT0FBT2IsR0FHTmEsT0FBT2IsR0FDYkUsS0FBS0ksWUFBWVEsc0JBQ2ZkLEVBQWdCLGFBQWUsWUFDL0JFLEtBQUtRLFVDckJKLFNBQVNLLEVBQWNDLEdBQzVCLElBQUlDLEdBQVUsRUFnQmQsT0FmSUQsRUFBTUUsV0FDUkQsRUFBVUEsR0FBb0QsSUFBekNELEVBQU1HLE1BQU1DLFdBQVdDLE9BQU9DLFFBRTlCLE1BQW5CTixFQUFNTyxXQUE0QyxpQkFBaEJQLEVBQU1HLFFBQzFDRixFQUFVQSxHQUFXRCxFQUFNRyxNQUFNRyxRQUFVTixFQUFNTyxXQUU1QixNQUFuQlAsRUFBTVEsV0FBNEMsaUJBQWhCUixFQUFNRyxRQUMxQ0YsRUFBVUEsR0FBV0QsRUFBTUcsTUFBTUcsUUFBVU4sRUFBTVEsV0FFbEMsTUFBYlIsRUFBTVMsS0FBc0MsaUJBQWhCVCxFQUFNRyxRQUNwQ0YsRUFBVUEsR0FBV0QsRUFBTUcsT0FBU0gsRUFBTVMsS0FFM0IsTUFBYlQsRUFBTVUsS0FBc0MsaUJBQWhCVixFQUFNRyxRQUNwQ0YsRUFBVUEsR0FBV0QsRUFBTUcsT0FBU0gsRUFBTVUsS0FFckNULEVDMUJGLFNBQVNVLEVBQ2RDLEVBQ0FDLEVBQ0FDLEdBRUEsTUFBTUMsRUFBaUJELEVBQVdYLE1BVWxDLE1BVDJDLENBQ3pDYSxjQUFjLEVBQ2RDLFlBQVksRUFDWkMsTUFHRSxPQURxQkgsRUFBZUksS0FBS2pDLFFDWC9DLElBQVlrQyxHQUFaLFNBQVlBLEdBQ1YsdUJBQ0EsMkJBRkYsQ0FBWUEsSUFBQUEsRUFBYSxLQUtsQixNQUFNQyxFQUNYeEMsWUFDU2UsRUFDQTBCLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBSkEsS0FBQTdCLEdBQUFBLEVBQ0EsS0FBQTBCLE1BQUFBLEVBQ0EsS0FBQUMsWUFBQUEsRUFDQSxLQUFBQyxPQUFBQSxFQUNBLEtBQUFDLE9BQUFBLEdDQ0osTUFBTUMsVUFSYixvQkFDWSxLQUFBQyxVQUEyQixHQUVyQ0MsYUFBYUMsR0FDWDNDLEtBQUt5QyxVQUFVRyxLQUFLRCxLQVV0QixjQUNFRSxRQU5NLEtBQUFDLFNBQXNCLEdBUzlCQyxxQkFDRSxPQUFJL0MsS0FBS2dELFdBR1RoRCxLQUFLZ0QsU0FBVyxJQUFJUixHQUZYeEMsS0FBS2dELFNBTWhCQyxXQUFXYixFQUFlYyxFQUFjWixHQUN0QyxNQUFNYSxFQUFhLElBQUloQixFQUNyQmlCLEtBQUtDLFNBQVNuQyxXQUNka0IsRUFDQWMsRUFDQVosRUFDQUosRUFBY29CLFFBRWhCdEQsS0FBSzhDLFNBQVNGLEtBQUtPLEdBRW5CbkQsS0FBS3VELGlCQUdQQyxvQkFBb0JDLEVBQW1CbEIsR0FDckMsTUFBTW1CLEVBQWMxRCxLQUFLOEMsU0FBU2EsTUFDL0JDLEdBQVlBLEVBQVFsRCxLQUFPK0MsSUFFMUJDLEdBQWVBLEVBQVluQixTQUFXQSxJQUN4Q21CLEVBQVluQixPQUFTQSxFQUNyQnZDLEtBQUt1RCxrQkFJREEsaUJBQ04sSUFBSyxNQUFNWixLQUFZM0MsS0FBS3lDLFVBQzFCRSxFQUFTM0MsS0FBSzhDLFNBQVNlLFVBSXRCLE1BQU1DLEVBQWV0QixFQUFhdUIsY0N0RGxDLE1BQU1DLFVBQXFCdEUsRUFLaENDLGNBQ0VrRCxNQUFNLGdCQUFpQixPQUFPLEVBQU0sY0FFcEM3QyxLQUFLaUUsa0JBQW9CakUsS0FBS1EsUUFBUTBELGNBQ3BDLFVBRUZsRSxLQUFLbUUsd0JBQTBCbkUsS0FBS1EsUUFBUTBELGNBQzFDLGdCQUVGbEUsS0FBS29FLG1CQUFxQnBFLEtBQUtRLFFBQVEwRCxjQUNyQyxXQUdGbEUsS0FBS3FFLFlBR1BBLFlBQ0VyRSxLQUFLUSxRQUFROEQsaUJBQWlCLFNBQVV0RSxLQUFLdUUsZUFHL0NDLGlCQUVRQyxrQkFDTixNQUFNckMsRUFBUXBDLEtBQUtpRSxrQkFBa0JoRCxNQUMvQmlDLEVBQU9sRCxLQUFLbUUsd0JBQXdCbEQsTUFDcENxQixFQUFTdEMsS0FBS29FLG1CQUFtQm5ELE1BUWpDeUQsRUFBNEIsQ0FDaEN6RCxNQUFPaUMsRUFDUGxDLFVBQVUsRUFDVkssVUFBVyxHQUVQc0QsRUFBOEIsQ0FDbEMxRCxPQUFRcUIsRUFDUnRCLFVBQVUsRUFDVk8sSUFBSyxFQUNMQyxJQUFLLEdBR1AsT0FDR1gsRUFuQmdDLENBQ2pDSSxNQUFPbUIsRUFDUHBCLFVBQVUsRUFDVkssVUFBVyxFQUNYQyxVQUFXLE1BZ0JWVCxFQUFjNkQsSUFDZDdELEVBQWM4RCxHQUtSLENBQUN2QyxFQUFPYyxHQUFPWixRQUh0QnNDLFFBQVFDLElBQUksaUJBUVJOLGNBQWNPLEdBQ3BCQSxFQUFNQyxpQkFDTkgsUUFBUUMsSUFBSTdFLE1BQ1osTUFBTWdGLEVBQVloRixLQUFLeUUsa0JBQ3ZCLEdBQUlRLE1BQU1DLFFBQVFGLEdBQVksQ0FDNUIsTUFBTzVDLEVBQU9jLEVBQU1aLEdBQVUwQyxFQUM5QmxCLEVBQWFiLFdBQVdiLEVBQU9jLEVBQU1aLE0sMFRBTnpDLEVBRENiLEcsNFdDOURJLE1BQU0wRCxVQUNIekYsRUFhUkMsWUFBWXlGLEVBQWdCeEIsR0FDMUJmLE1BQU0saUJBQWtCdUMsR0FBUSxFQUFPeEIsRUFBUWxELElBQy9DVixLQUFLNEQsUUFBVUEsRUFFZjVELEtBQUtxRSxZQUNMckUsS0FBS3dFLGdCQWJIYSxjQUNGLE9BQTRCLElBQXhCckYsS0FBSzRELFFBQVF0QixPQUNSLDhCQUVBLEdBQUd0QyxLQUFLNEQsUUFBUXRCLG1DQWEzQmdELFlBQVlSLEdBQ1ZBLEVBQU1TLGFBQWNDLFFBQVEsYUFBY3hGLEtBQUs0RCxRQUFRbEQsSUFDdkRvRSxFQUFNUyxhQUFjRSxjQUFnQixPQUd0Q0MsVUFBVVosR0FDUkYsUUFBUUMsSUFBSTdFLE1BR2RxRSxZQUNFckUsS0FBS1EsUUFBUThELGlCQUFpQixZQUFhdEUsS0FBS3NGLGFBQ2hEdEYsS0FBS1EsUUFBUThELGlCQUFpQixVQUFXdEUsS0FBSzBGLFdBR2hEbEIsZ0JBQ0V4RSxLQUFLUSxRQUFRMEQsY0FBYyxNQUFPeUIsWUFBYzNGLEtBQUs0RCxRQUFReEIsTUFDN0RwQyxLQUFLUSxRQUFRMEQsY0FBYyxNQUFPeUIsWUFBYzNGLEtBQUtxRixRQUNyRHJGLEtBQUtRLFFBQVEwRCxjQUFjLEtBQU15QixZQUFjM0YsS0FBSzRELFFBQVF2QixhQWpCOUQsR0FEQ1osRyxnQ0FNRCxHQURDQSxHLHdXQ3hCSSxNQUFNbUUsVUFDSGxHLEVBS1JDLFlBQW9Ca0csR0FDbEJoRCxNQUFNLGVBQWdCLE9BQU8sRUFBTyxHQUFHZ0QsY0FEckIsS0FBQUEsS0FBQUEsRUFFbEI3RixLQUFLOEYsZ0JBQWtCLEdBRXZCOUYsS0FBS3FFLFlBQ0xyRSxLQUFLd0UsZ0JBSVB1QixXQUFXakIsR0FDTEEsRUFBTVMsY0FBZ0QsZUFBaENULEVBQU1TLGFBQWFTLE1BQU0sS0FDakRsQixFQUFNQyxpQkFDUy9FLEtBQUtRLFFBQVEwRCxjQUFjLE1BQ25DK0IsVUFBVUMsSUFBSSxjQUt6QkMsT0FBT3JCLEdBQ0xBLEVBQU1DLGlCQUNOLE1BQU1xQixFQUFTdEIsRUFBTVMsYUFBY2MsUUFBUSxjQUMzQ3ZDLEVBQWFOLG9CQUNYNEMsRUFDYyxXQUFkcEcsS0FBSzZGLEtBQW9CM0QsRUFBY29CLE9BQVNwQixFQUFjb0UsVUFFakR0RyxLQUFLUSxRQUFRMEQsY0FBYyxNQUNuQytCLFVBQVVNLE9BQU8sYUFJMUJDLFlBQVkxQixHQUNLOUUsS0FBS1EsUUFBUTBELGNBQWMsTUFDbkMrQixVQUFVTSxPQUFPLGFBRzFCbEMsWUFDRXJFLEtBQUtRLFFBQVE4RCxpQkFBaUIsV0FBWXRFLEtBQUsrRixZQUMvQy9GLEtBQUtRLFFBQVE4RCxpQkFBaUIsWUFBYXRFLEtBQUt3RyxhQUNoRHhHLEtBQUtRLFFBQVE4RCxpQkFBaUIsT0FBUXRFLEtBQUttRyxRQUUzQ3JDLEVBQWFwQixjQUFjSSxJQUN6QkEsRUFBV0EsRUFBUzJELFFBQVE3QyxHQUNSLFdBQWQ1RCxLQUFLNkYsS0FDQWpDLEVBQVFyQixTQUFXTCxFQUFjb0IsT0FFakNNLEVBQVFyQixTQUFXTCxFQUFjb0UsV0FHNUN0RyxLQUFLOEYsZ0JBQWtCaEQsRUFDdkI5QyxLQUFLMEcsb0JBSVRsQyxnQkFDRSxNQUFNbUMsRUFBUyxHQUFHM0csS0FBSzZGLHFCQUN2QjdGLEtBQUtRLFFBQVEwRCxjQUFjLE1BQU94RCxHQUFLaUcsRUFDdkMzRyxLQUFLUSxRQUFRMEQsY0FBYyxNQUFPeUIsWUFDaEMzRixLQUFLNkYsS0FBS2UsY0FBZ0IsWUFHdEJGLGlCQUNTeEcsU0FBU0MsZUFDdEIsR0FBR0gsS0FBSzZGLHNCQUVIZ0IsVUFBWSxHQUNuQixJQUFLLE1BQU1DLEtBQVE5RyxLQUFLOEYsZ0JBQWlCLENBQ3ZDLE1BQU1hLEVBQVMzRyxLQUFLUSxRQUFRMEQsY0FBYyxNQUFPeEQsR0FDakQsSUFBSXlFLEVBQVl3QixFQUFRRyxLQTFENUIsR0FEQ3JGLEcsK0JBVUQsR0FEQ0EsRywyQkFhRCxHQURDQSxHLGdDQ3pDYyxJQUFJdUMsRUFDSyxJQUFJNEIsRUFBWSxVQUNkLElBQUlBLEVBQVksYSIsInNvdXJjZXMiOlsid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy9jb21wb25lbnRzL2Jhc2UtY29tcG9uZW50LnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy91dGlsL3ZhbGlkYXRpb24udHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10eXBlc2NyaXB0Ly4vc3JjL2RlY29yYXRvcnMvYXV0b2JpbmQudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10eXBlc2NyaXB0Ly4vc3JjL21vZGVscy9wcm9qZWN0LnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy9zdGF0ZS9wcm9qZWN0LXN0YXRlLnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10eXBlc2NyaXB0Ly4vc3JjL2NvbXBvbmVudHMvcHJvamVjdC1pdGVtLnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvYXBwLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvbXBvbmVudCBCYXNlIENsYXNzXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQ29tcG9uZW50PFQgZXh0ZW5kcyBIVE1MRWxlbWVudCwgVSBleHRlbmRzIEhUTUxFbGVtZW50PiB7XG4gIHRlbXBsYXRlRWxlbWVudDogSFRNTFRlbXBsYXRlRWxlbWVudDtcbiAgaG9zdEVsZW1lbnQ6IFQ7XG4gIGVsZW1lbnQ6IFU7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgdGVtcGxhdGVJZDogc3RyaW5nLFxuICAgIGhvc3RFbGVtZW50SWQ6IHN0cmluZyxcbiAgICBpbnNlcnRBdFN0YXJ0OiBib29sZWFuLFxuICAgIG5ld0VsZW1lbnRJZD86IHN0cmluZ1xuICApIHtcbiAgICB0aGlzLnRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxuICAgICAgdGVtcGxhdGVJZFxuICAgICkhIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XG4gICAgdGhpcy5ob3N0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvc3RFbGVtZW50SWQpISBhcyBUO1xuXG4gICAgY29uc3QgaW1wb3J0ZWROb2RlID0gZG9jdW1lbnQuaW1wb3J0Tm9kZShcbiAgICAgIHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsXG4gICAgICB0cnVlXG4gICAgKTtcbiAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgYXMgVTtcbiAgICBpZiAobmV3RWxlbWVudElkKSB7XG4gICAgICB0aGlzLmVsZW1lbnQuaWQgPSBuZXdFbGVtZW50SWQ7XG4gICAgfVxuICAgIHRoaXMuYXR0YWNoKGluc2VydEF0U3RhcnQpO1xuICB9XG5cbiAgcHJpdmF0ZSBhdHRhY2goaW5zZXJ0QXRTdGFydDogYm9vbGVhbikge1xuICAgIHRoaXMuaG9zdEVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFxuICAgICAgaW5zZXJ0QXRTdGFydCA/IFwiYWZ0ZXJiZWdpblwiIDogXCJiZWZvcmVlbmRcIixcbiAgICAgIHRoaXMuZWxlbWVudFxuICAgICk7XG4gIH1cblxuICBhYnN0cmFjdCBjb25maWd1cmUoKTogdm9pZDtcbiAgYWJzdHJhY3QgcmVuZGVyQ29udGVudCgpOiB2b2lkO1xufVxuIiwiLy8/IFZhbGlkYXRpb24gQ29uZmlnXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRhYmxlIHtcbiAgdmFsdWU6IHN0cmluZyB8IG51bWJlcjtcbiAgcmVxdWlyZWQ/OiBib29sZWFuO1xuICBtaW5MZW5ndGg/OiBudW1iZXI7XG4gIG1heExlbmd0aD86IG51bWJlcjtcbiAgbWluPzogbnVtYmVyO1xuICBtYXg/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUlucHV0KGlucHV0OiBWYWxpZGF0YWJsZSkge1xuICBsZXQgaXNWYWxpZCA9IHRydWU7XG4gIGlmIChpbnB1dC5yZXF1aXJlZCkge1xuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIGlucHV0LnZhbHVlLnRvU3RyaW5nKCkudHJpbSgpLmxlbmd0aCAhPT0gMDtcbiAgfVxuICBpZiAoaW5wdXQubWluTGVuZ3RoICE9IG51bGwgJiYgdHlwZW9mIGlucHV0LnZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgaW5wdXQudmFsdWUubGVuZ3RoID49IGlucHV0Lm1pbkxlbmd0aDtcbiAgfVxuICBpZiAoaW5wdXQubWF4TGVuZ3RoICE9IG51bGwgJiYgdHlwZW9mIGlucHV0LnZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgaW5wdXQudmFsdWUubGVuZ3RoIDw9IGlucHV0Lm1heExlbmd0aDtcbiAgfVxuICBpZiAoaW5wdXQubWluICE9IG51bGwgJiYgdHlwZW9mIGlucHV0LnZhbHVlID09PSBcIm51bWJlclwiKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgaW5wdXQudmFsdWUgPj0gaW5wdXQubWluO1xuICB9XG4gIGlmIChpbnB1dC5tYXggIT0gbnVsbCAmJiB0eXBlb2YgaW5wdXQudmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiBpbnB1dC52YWx1ZSA8PSBpbnB1dC5tYXg7XG4gIH1cbiAgcmV0dXJuIGlzVmFsaWQ7XG59XG4iLCIvLz8gQXV0b2JpbmQgZGVjb3JhdG9yXG5leHBvcnQgZnVuY3Rpb24gQXV0b2JpbmQoXG4gIF86IGFueSxcbiAgXzI6IHN0cmluZyB8IFN5bWJvbCxcbiAgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yXG4pIHtcbiAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICBjb25zdCBhZGp1c3RlZE1ldGhvZDogUHJvcGVydHlEZXNjcmlwdG9yID0ge1xuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICBnZXQoKSB7XG4gICAgICAvL3RoaXMgd2lsbCBiZSB0cmlnZ2VyZWQgd2hlbiB0aGUgbWV0aG9kIGlzIGNhbGxlZFxuICAgICAgY29uc3QgYmluZEZ1bmN0aW9uID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTsgLy8gYW5kIHRoZW4gaXQgd2lsbCBiaW5kIHRoaXMgdG8gd2hvZXZlciBjYWxsZWQgdGhlIG1ldGhvZCAoIHRoZSBvYmplY3QpXG4gICAgICByZXR1cm4gYmluZEZ1bmN0aW9uO1xuICAgIH0sXG4gIH07XG4gIHJldHVybiBhZGp1c3RlZE1ldGhvZDsgLy8gYW5kIHRoZW4gd2UgcmV0dXJuIHRoZSBhZGp1c3RlZCBtZXRob2Rcbn1cbiIsIi8vID8gUHJvamVjdCB0eXBlXG5leHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHtcbiAgQWN0aXZlLFxuICBGaW5pc2hlZCxcbn1cblxuZXhwb3J0IGNsYXNzIFByb2plY3Qge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgaWQ6IHN0cmluZyxcbiAgICBwdWJsaWMgdGl0bGU6IHN0cmluZyxcbiAgICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyxcbiAgICBwdWJsaWMgcGVvcGxlOiBudW1iZXIsXG4gICAgcHVibGljIHN0YXR1czogUHJvamVjdFN0YXR1c1xuICApIHt9XG59XG4iLCJpbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XG5cbi8vID9Qcm9qZWN0IFN0YXRlIE1hbmFnZW1lbnRcbnR5cGUgTGlzdGVuZXI8VD4gPSAocHJvamVjdHM6IFRbXSkgPT4gdm9pZDtcblxuY2xhc3MgU3RhdGU8VD4ge1xuICBwcm90ZWN0ZWQgbGlzdGVuZXJzOiBMaXN0ZW5lcjxUPltdID0gW107XG5cbiAgYWRkTGlzdGVuZXJzKGxpc3RlbmVyOiBMaXN0ZW5lcjxUPikge1xuICAgIHRoaXMubGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBTdGF0ZTxQcm9qZWN0PiB7XG4gIHByaXZhdGUgcHJvamVjdHM6IFByb2plY3RbXSA9IFtdO1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUHJvamVjdFN0YXRlO1xuXG4gIC8vIHByaXZhdGUgY29uc3RydWN0b3IgbWVhbnMgdGhhdCB0aGlzIGNsYXNzIHNob3VsZG4ndCBiZSBhYmxlIHRvIGJlXG4gIC8vIG1hbnVhbGx5IGNvbnN0cnVjdGVkIG91dHNpZGUgb2YgdGhpcyBjbGFzXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcbiAgICBpZiAodGhpcy5pbnN0YW5jZSkge1xuICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XG4gICAgfVxuICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgUHJvamVjdFN0YXRlKCk7XG4gICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XG4gIH1cblxuICBhZGRQcm9qZWN0KHRpdGxlOiBzdHJpbmcsIGRlc2M6IHN0cmluZywgcGVvcGxlOiBudW1iZXIpIHtcbiAgICBjb25zdCBuZXdQcm9qZWN0ID0gbmV3IFByb2plY3QoXG4gICAgICBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKCksXG4gICAgICB0aXRsZSxcbiAgICAgIGRlc2MsXG4gICAgICBwZW9wbGUsXG4gICAgICBQcm9qZWN0U3RhdHVzLkFjdGl2ZVxuICAgICk7XG4gICAgdGhpcy5wcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xuXG4gICAgdGhpcy51cGRhdGVMaXN0ZW5lcigpO1xuICB9XG5cbiAgc3dpdGNoUHJvamVjdFN0YXR1cyhwcm9qZWN0SWQ6IHN0cmluZywgc3RhdHVzOiBQcm9qZWN0U3RhdHVzKSB7XG4gICAgY29uc3QgZmluZFByb2plY3QgPSB0aGlzLnByb2plY3RzLmZpbmQoXG4gICAgICAocHJvamVjdCkgPT4gcHJvamVjdC5pZCA9PT0gcHJvamVjdElkXG4gICAgKTtcbiAgICBpZiAoZmluZFByb2plY3QgJiYgZmluZFByb2plY3Quc3RhdHVzICE9PSBzdGF0dXMpIHtcbiAgICAgIGZpbmRQcm9qZWN0LnN0YXR1cyA9IHN0YXR1cztcbiAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXIoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUxpc3RlbmVyKCkge1xuICAgIGZvciAoY29uc3QgbGlzdGVuZXIgb2YgdGhpcy5saXN0ZW5lcnMpIHtcbiAgICAgIGxpc3RlbmVyKHRoaXMucHJvamVjdHMuc2xpY2UoKSk7XG4gICAgfVxuICB9XG59XG5leHBvcnQgY29uc3QgcHJvamVjdFN0YXRlID0gUHJvamVjdFN0YXRlLmdldEluc3RhbmNlKCk7XG4iLCJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiO1xuaW1wb3J0IHsgVmFsaWRhdGFibGUsIHZhbGlkYXRlSW5wdXQgfSBmcm9tIFwiLi4vdXRpbC92YWxpZGF0aW9uXCI7XG5pbXBvcnQgeyBBdXRvYmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG9iaW5kXCI7XG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tIFwiLi4vc3RhdGUvcHJvamVjdC1zdGF0ZVwiO1xuXG4vLz8gUHJvamVjdGlucHV0IGNsYXNzXG5leHBvcnQgY2xhc3MgUHJvamVjdElucHV0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRm9ybUVsZW1lbnQ+IHtcbiAgdGl0bGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG4gIGRlc2NyaXB0aW9uSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xuICBwZW9wbGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoXCJwcm9qZWN0LWlucHV0XCIsIFwiYXBwXCIsIHRydWUsIFwidXNlci1pbnB1dFwiKTtcblxuICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiI3RpdGxlXCJcbiAgICApISBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiI2Rlc2NyaXB0aW9uXCJcbiAgICApISBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIiNwZW9wbGVcIlxuICAgICkhIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICB9XG5cbiAgY29uZmlndXJlKCkge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuc3VibWl0SGFuZGxlcik7XG4gIH1cblxuICByZW5kZXJDb250ZW50KCkge31cblxuICBwcml2YXRlIGdhdGhlclVzZXJJbnB1dCgpOiBbc3RyaW5nLCBzdHJpbmcsIG51bWJlcl0gfCB2b2lkIHtcbiAgICBjb25zdCB0aXRsZSA9IHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWU7XG4gICAgY29uc3QgZGVzYyA9IHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQudmFsdWU7XG4gICAgY29uc3QgcGVvcGxlID0gdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWU7XG5cbiAgICBjb25zdCB2YWxpZGF0ZVRpdGxlOiBWYWxpZGF0YWJsZSA9IHtcbiAgICAgIHZhbHVlOiB0aXRsZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgbWluTGVuZ3RoOiA1LFxuICAgICAgbWF4TGVuZ3RoOiA1MCxcbiAgICB9O1xuICAgIGNvbnN0IHZhbGlkYXRlRGVzYzogVmFsaWRhdGFibGUgPSB7XG4gICAgICB2YWx1ZTogZGVzYyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgbWluTGVuZ3RoOiA1LFxuICAgIH07XG4gICAgY29uc3QgdmFsaWRhdGVQZW9wbGU6IFZhbGlkYXRhYmxlID0ge1xuICAgICAgdmFsdWU6ICtwZW9wbGUsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIG1pbjogMSxcbiAgICAgIG1heDogNSxcbiAgICB9O1xuXG4gICAgaWYgKFxuICAgICAgIXZhbGlkYXRlSW5wdXQodmFsaWRhdGVUaXRsZSkgfHxcbiAgICAgICF2YWxpZGF0ZUlucHV0KHZhbGlkYXRlRGVzYykgfHxcbiAgICAgICF2YWxpZGF0ZUlucHV0KHZhbGlkYXRlUGVvcGxlKVxuICAgICkge1xuICAgICAgY29uc29sZS5sb2coYEludmFsaWQgaW5wdXRgKTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFt0aXRsZSwgZGVzYywgK3Blb3BsZV07XG4gICAgfVxuICB9XG5cbiAgQEF1dG9iaW5kXG4gIHByaXZhdGUgc3VibWl0SGFuZGxlcihldmVudDogRXZlbnQpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnNvbGUubG9nKHRoaXMpO1xuICAgIGNvbnN0IHVzZXJJbnB1dCA9IHRoaXMuZ2F0aGVyVXNlcklucHV0KCk7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodXNlcklucHV0KSkge1xuICAgICAgY29uc3QgW3RpdGxlLCBkZXNjLCBwZW9wbGVdID0gdXNlcklucHV0O1xuICAgICAgcHJvamVjdFN0YXRlLmFkZFByb2plY3QodGl0bGUsIGRlc2MsIHBlb3BsZSk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiO1xuaW1wb3J0IHsgRHJhZ2dhYmxlIH0gZnJvbSBcIi4uL21vZGVscy9kcmFnLWRyb3BcIjtcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcbmltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSBcIi4uL2RlY29yYXRvcnMvYXV0b2JpbmRcIjtcblxuLy8gPyBQcm9qZWN0SXRlbSBjbGFzc1xuZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtXG4gIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+XG4gIGltcGxlbWVudHMgRHJhZ2dhYmxlXG57XG4gIHByaXZhdGUgcHJvamVjdDogUHJvamVjdDtcblxuICBnZXQgcGVyc29ucygpIHtcbiAgICBpZiAodGhpcy5wcm9qZWN0LnBlb3BsZSA9PT0gMSkge1xuICAgICAgcmV0dXJuIGAxIHBlcnNvbiBpcyB3b3JraW5nIG9uIHRoaXNgO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYCR7dGhpcy5wcm9qZWN0LnBlb3BsZX0gcGVvcGxlIGlzIHdvcmtpbmcgb24gdGhpc2A7XG4gICAgfVxuICB9XG5cbiAgY29uc3RydWN0b3IoaG9zdElkOiBzdHJpbmcsIHByb2plY3Q6IFByb2plY3QpIHtcbiAgICBzdXBlcihcInNpbmdsZS1wcm9qZWN0XCIsIGhvc3RJZCwgZmFsc2UsIHByb2plY3QuaWQpO1xuICAgIHRoaXMucHJvamVjdCA9IHByb2plY3Q7XG5cbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xuICB9XG5cbiAgQEF1dG9iaW5kXG4gIGRyYWdTdGFydEZuKGV2ZW50OiBEcmFnRXZlbnQpIHtcbiAgICBldmVudC5kYXRhVHJhbnNmZXIhLnNldERhdGEoXCJ0ZXh0L3BsYWluXCIsIHRoaXMucHJvamVjdC5pZCk7XG4gICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5lZmZlY3RBbGxvd2VkID0gXCJtb3ZlXCI7XG4gIH1cbiAgQEF1dG9iaW5kXG4gIGRyYWdFbmRGbihldmVudDogRHJhZ0V2ZW50KSB7XG4gICAgY29uc29sZS5sb2codGhpcyk7XG4gIH1cblxuICBjb25maWd1cmUoKSB7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgdGhpcy5kcmFnU3RhcnRGbik7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnZW5kXCIsIHRoaXMuZHJhZ0VuZEZuKTtcbiAgfVxuXG4gIHJlbmRlckNvbnRlbnQoKSB7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJoMlwiKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJoM1wiKSEudGV4dENvbnRlbnQgPSB0aGlzLnBlcnNvbnM7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJwXCIpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC5kZXNjcmlwdGlvbjtcbiAgfVxufVxuIiwiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjtcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcbmltcG9ydCB7IERyYWdUYXJnZXQgfSBmcm9tIFwiLi4vbW9kZWxzL2RyYWctZHJvcFwiO1xuaW1wb3J0IHsgQXV0b2JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xuaW1wb3J0IHsgUHJvamVjdFN0YXR1cyB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiO1xuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcbmltcG9ydCB7IFByb2plY3RJdGVtIH0gZnJvbSBcIi4vcHJvamVjdC1pdGVtXCI7XG5cbi8vID8gUHJvamVjdExpc3QgY2xhc3NcbmV4cG9ydCBjbGFzcyBQcm9qZWN0TGlzdFxuICBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEVsZW1lbnQ+XG4gIGltcGxlbWVudHMgRHJhZ1RhcmdldFxue1xuICBhc3NpZ25lZFByb2plY3Q6IFByb2plY3RbXTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHR5cGU6IFwiYWN0aXZlXCIgfCBcImZpbmlzaGVkXCIpIHtcbiAgICBzdXBlcihcInByb2plY3QtbGlzdFwiLCBcImFwcFwiLCBmYWxzZSwgYCR7dHlwZX0tcHJvamVjdHNgKTtcbiAgICB0aGlzLmFzc2lnbmVkUHJvamVjdCA9IFtdO1xuXG4gICAgdGhpcy5jb25maWd1cmUoKTtcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcbiAgfVxuXG4gIEBBdXRvYmluZFxuICBkcmFnT3ZlckZuKGV2ZW50OiBEcmFnRXZlbnQpIHtcbiAgICBpZiAoZXZlbnQuZGF0YVRyYW5zZmVyICYmIGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlc1swXSA9PT0gXCJ0ZXh0L3BsYWluXCIpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IC8vIGFsbG93IGRyb3AgdG8gaGFwcGVuXG4gICAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcInVsXCIpITtcbiAgICAgIGxpc3RFbC5jbGFzc0xpc3QuYWRkKFwiZHJvcHBhYmxlXCIpO1xuICAgIH1cbiAgfVxuXG4gIEBBdXRvYmluZFxuICBkcm9wRm4oZXZlbnQ6IERyYWdFdmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgZHJvcElkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKFwidGV4dC9wbGFpblwiKTtcbiAgICBwcm9qZWN0U3RhdGUuc3dpdGNoUHJvamVjdFN0YXR1cyhcbiAgICAgIGRyb3BJZCxcbiAgICAgIHRoaXMudHlwZSA9PT0gXCJhY3RpdmVcIiA/IFByb2plY3RTdGF0dXMuQWN0aXZlIDogUHJvamVjdFN0YXR1cy5GaW5pc2hlZFxuICAgICk7XG4gICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJ1bFwiKSE7XG4gICAgbGlzdEVsLmNsYXNzTGlzdC5yZW1vdmUoXCJkcm9wcGFibGVcIik7XG4gIH1cblxuICBAQXV0b2JpbmRcbiAgZHJhZ0xlYXZlRm4oZXZlbnQ6IERyYWdFdmVudCkge1xuICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwidWxcIikhO1xuICAgIGxpc3RFbC5jbGFzc0xpc3QucmVtb3ZlKFwiZHJvcHBhYmxlXCIpO1xuICB9XG5cbiAgY29uZmlndXJlKCkge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgdGhpcy5kcmFnT3ZlckZuKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdsZWF2ZVwiLCB0aGlzLmRyYWdMZWF2ZUZuKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgdGhpcy5kcm9wRm4pO1xuXG4gICAgcHJvamVjdFN0YXRlLmFkZExpc3RlbmVycygocHJvamVjdHM6IFByb2plY3RbXSkgPT4ge1xuICAgICAgcHJvamVjdHMgPSBwcm9qZWN0cy5maWx0ZXIoKHByb2plY3QpID0+IHtcbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gXCJhY3RpdmVcIikge1xuICAgICAgICAgIHJldHVybiBwcm9qZWN0LnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5BY3RpdmU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHByb2plY3Quc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0ID0gcHJvamVjdHM7XG4gICAgICB0aGlzLnJlbmRlclByb2plY3RzKCk7XG4gICAgfSk7XG4gIH1cblxuICByZW5kZXJDb250ZW50KCkge1xuICAgIGNvbnN0IGxpc3RJZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGA7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJ1bFwiKSEuaWQgPSBsaXN0SWQ7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJoMlwiKSEudGV4dENvbnRlbnQgPVxuICAgICAgdGhpcy50eXBlLnRvVXBwZXJDYXNlKCkgKyBcIiBQUk9KRUNUU1wiO1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJQcm9qZWN0cygpIHtcbiAgICBjb25zdCBsaXN0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgICAgIGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGBcbiAgICApISBhcyBIVE1MVUxpc3RFbGVtZW50O1xuICAgIGxpc3RFbC5pbm5lckhUTUwgPSBcIlwiO1xuICAgIGZvciAoY29uc3QgaXRlbSBvZiB0aGlzLmFzc2lnbmVkUHJvamVjdCkge1xuICAgICAgY29uc3QgbGlzdElkID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJ1bFwiKSEuaWQ7XG4gICAgICBuZXcgUHJvamVjdEl0ZW0obGlzdElkLCBpdGVtKTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IFByb2plY3RJbnB1dCB9IGZyb20gXCIuL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dFwiO1xuaW1wb3J0IHsgUHJvamVjdExpc3QgfSBmcm9tIFwiLi9jb21wb25lbnRzL3Byb2plY3QtbGlzdFwiO1xuXG5jb25zdCBuZXdJbnB1dCA9IG5ldyBQcm9qZWN0SW5wdXQoKTtcbmNvbnN0IGFjdGl2ZVByb2plY3RMaXN0ID0gbmV3IFByb2plY3RMaXN0KFwiYWN0aXZlXCIpO1xuY29uc3QgZmluaXNoZWRQcm9qZWN0TGlzdCA9IG5ldyBQcm9qZWN0TGlzdChcImZpbmlzaGVkXCIpO1xuXG4vKiBcbkhpIGl0IHRvb2sgbWUgYWJvdXQgYW4gaG91ciB0byBmaWd1cmUgaXQgb3V0LiBJIHdpbGwgbWFrZSBpdCBjcnlzdGFsIGNsZWFyLlxuXG5TdGVwIDE6IEluc3RhbnRpYXRpb24gb2YgUHJvamVjdExpc3QgQ2xhc3NcblxuV2hlbiB5b3UgZmlyc3QgaW5zdGFudGlhdGUgUHJvamVjdExpc3QgQ2xhc3NcblxuICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcigocHJvamVjdHM6IGFueVtdKSA9PiB7XG4gICAgICAgICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gcHJvamVjdHM7XG4gICAgICAgICAgdGhpcy5yZW5kZXJQcm9qZWN0cygpO1xuICAgICAgICB9KTtcblxuYWJvdmUgYmxvY2sgb2YgY29kZSB3aWxsIGJlIGV4ZWN1dGVkLCBtZWFucyB0aGF0IGFub255bW91cyBmdW5jdGlvbiB3aWxsIGdvIGFuZCBzaXQgKG5vLWV4ZWN1dGlvbiB3aWxsIGhhcHBlbikgaW5zaWRlIGxpc3RlbmVyc1tdIGFycmF5LiBCZWNhdXNlLCB0aGUgd29yayBvZiBhZGRMaXN0ZW5lcigpIGZ1bmN0aW9uIGlzIGp1c3QgdG8gYWRkIGEgbmV3IGZ1bmN0aW9uIGluc2lkZSBsaXN0ZW5lcnNbXSBhcnJheSBldmVyeSB0aW1lIGl0IGdldCBjYWxsZWQuXG5cblN0ZXAgMjogIFdoZW4gbmV3IHByb2plY3QgaXMgYWRkZWQgLyBhZnRlciB1c2VyIGNsaWNrIHN1Ym1pdCBidXR0b25cblxuICAgIGZvciAoY29uc3QgbGlzdGVuZXJGbiBvZiB0aGlzLmxpc3RlbmVycykge1xuICAgICAgICAgIGxpc3RlbmVyRm4odGhpcy5wcm9qZWN0cy5zbGljZSgpKTtcbiAgICAgICAgfVxuXG5IYXZlIGEgbG9vayBpbiB0aGUgYWJvdmUgY29kZSwgd2UgYXJlIGl0ZXJhdGluZyB0aHJvdWdoIGV2ZXJ5IGZ1bmN0aW9ucyBpbnNpZGUgbGlzdGVuZXJGbigpIGFuZCBleGVjdXRpbmcgdGhlbSBieSBwYXNzaW5nIGJyYW5kIG5ldyBhcnJheVtdIG9mIHByb2plY3RzLiBUaGF0IG1lYW5zIG91ciBhbm9ueW1vdXMgZnVuY3Rpb24gKHNob3duIGJlbG93KSB3aGljaCBpcyBhbHJlYWR5IGluc2lkZSBsaXN0ZW5lcltdIGFycmF5IHdpbGwgYmUgZXhlY3V0ZWQuIEl0IHdpbGwgZ2V0IGJyYW5kIG5ldyBwcm9qZWN0c1tdIGFycmF5IGFzIGFuIGFyZ3VtZW50LCB3aGljaCBpcyB3aGF0IGl0IG5lZWRzLiBFdmVudHVhbGx5LCBhZnRlciBleGVjdXRpb24gIHRoaXMuYXNzaWduZWRQcm9qZWN0cyB3aWxsIHN0b3JlIGEgYnJhbmQgbmV3IGFycmF5IG9mIHByb2plY3RzLCBhbmQgd2lsbCByZW5kZXIgaXQgaW4gc2NyZWVuLlxuXG4gICAgKHByb2plY3RzOiBhbnlbXSkgPT4ge1xuICAgICAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IHByb2plY3RzO1xuICAgICAgICAgIHRoaXMucmVuZGVyUHJvamVjdHMoKTtcbiAgICAgICAgfVxuXG4qL1xuIl0sIm5hbWVzIjpbIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwidGVtcGxhdGVJZCIsImhvc3RFbGVtZW50SWQiLCJpbnNlcnRBdFN0YXJ0IiwibmV3RWxlbWVudElkIiwidGhpcyIsInRlbXBsYXRlRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJob3N0RWxlbWVudCIsImltcG9ydGVkTm9kZSIsImltcG9ydE5vZGUiLCJjb250ZW50IiwiZWxlbWVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiaWQiLCJhdHRhY2giLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJ2YWxpZGF0ZUlucHV0IiwiaW5wdXQiLCJpc1ZhbGlkIiwicmVxdWlyZWQiLCJ2YWx1ZSIsInRvU3RyaW5nIiwidHJpbSIsImxlbmd0aCIsIm1pbkxlbmd0aCIsIm1heExlbmd0aCIsIm1pbiIsIm1heCIsIkF1dG9iaW5kIiwiXyIsIl8yIiwiZGVzY3JpcHRvciIsIm9yaWdpbmFsTWV0aG9kIiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsImJpbmQiLCJQcm9qZWN0U3RhdHVzIiwiUHJvamVjdCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwZW9wbGUiLCJzdGF0dXMiLCJQcm9qZWN0U3RhdGUiLCJsaXN0ZW5lcnMiLCJhZGRMaXN0ZW5lcnMiLCJsaXN0ZW5lciIsInB1c2giLCJzdXBlciIsInByb2plY3RzIiwic3RhdGljIiwiaW5zdGFuY2UiLCJhZGRQcm9qZWN0IiwiZGVzYyIsIm5ld1Byb2plY3QiLCJNYXRoIiwicmFuZG9tIiwiQWN0aXZlIiwidXBkYXRlTGlzdGVuZXIiLCJzd2l0Y2hQcm9qZWN0U3RhdHVzIiwicHJvamVjdElkIiwiZmluZFByb2plY3QiLCJmaW5kIiwicHJvamVjdCIsInNsaWNlIiwicHJvamVjdFN0YXRlIiwiZ2V0SW5zdGFuY2UiLCJQcm9qZWN0SW5wdXQiLCJ0aXRsZUlucHV0RWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJkZXNjcmlwdGlvbklucHV0RWxlbWVudCIsInBlb3BsZUlucHV0RWxlbWVudCIsImNvbmZpZ3VyZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzdWJtaXRIYW5kbGVyIiwicmVuZGVyQ29udGVudCIsImdhdGhlclVzZXJJbnB1dCIsInZhbGlkYXRlRGVzYyIsInZhbGlkYXRlUGVvcGxlIiwiY29uc29sZSIsImxvZyIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ1c2VySW5wdXQiLCJBcnJheSIsImlzQXJyYXkiLCJQcm9qZWN0SXRlbSIsImhvc3RJZCIsInBlcnNvbnMiLCJkcmFnU3RhcnRGbiIsImRhdGFUcmFuc2ZlciIsInNldERhdGEiLCJlZmZlY3RBbGxvd2VkIiwiZHJhZ0VuZEZuIiwidGV4dENvbnRlbnQiLCJQcm9qZWN0TGlzdCIsInR5cGUiLCJhc3NpZ25lZFByb2plY3QiLCJkcmFnT3ZlckZuIiwidHlwZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJkcm9wRm4iLCJkcm9wSWQiLCJnZXREYXRhIiwiRmluaXNoZWQiLCJyZW1vdmUiLCJkcmFnTGVhdmVGbiIsImZpbHRlciIsInJlbmRlclByb2plY3RzIiwibGlzdElkIiwidG9VcHBlckNhc2UiLCJpbm5lckhUTUwiLCJpdGVtIl0sInNvdXJjZVJvb3QiOiIifQ==